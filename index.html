<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Move Box with Keyboard</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #f0f0f0;
            overflow: hidden;
        }

        #box {
            width: 50px;
            height: 200px;
            background: teal;
            position: absolute;
            top: 10px;
            left: 10px;
        }

        #ai {
            width: 50px;
            height: 200px;
            background: orange;
            position: absolute;
            top: 10px;
            right: 10px;
        }

        #ball {
            width: 40px;
            height: 40px;
            background: crimson;
            border-radius: 50%;
            position: absolute;
            top: 100px;
            left: 200px;
        }

        #score {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-family: Arial, Helvetica, sans-serif;
            font-weight: bold;
        }

        #modeSelect {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            font-family: Arial, sans-serif;
        }

        #modeSelect button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="box"></div>
    <div id="ai"></div>
    <div id="ball"></div>
    <div id="score">Player: 0 | Opponent: 0</div>

    <!-- Mode Selection -->
    <div id="modeSelect">
        <h2>Select Mode</h2>
        <button id="aiMode">Play vs AI</button>
        <button id="p2Mode">Play vs Player 2</button>
    </div>

    <script>
        const box = document.getElementById("box");
        const ai = document.getElementById("ai");
        const ball = document.getElementById("ball");
        const scoreBoard = document.getElementById("score");
        const modeSelect = document.getElementById("modeSelect");
        const aiBtn = document.getElementById("aiMode");
        const p2Btn = document.getElementById("p2Mode");

        let x = 10, y = 200;
        let speed = 3;
        let direction = null;

        let aiY = 200;
        let aiSpeed = 0; // default

        let ballX = 700, ballY = 300;
        let ballSpeedX = 0, ballSpeedY = 0;
        const boxWidth = 50, boxHeight = 200;
        const ballSize = 40;

        // scores
        let playerScore = 0;
        let aiScore = 0;

        // Modes
        let aiEnabled = true;

        // Detect key pressed
        document.addEventListener("keydown", (e) => {
            if (e.key === "w") direction = "up";
            if (e.key === "s") direction = "down";

            // Player 2 controls (only if AI is disabled)
            if (!aiEnabled) {
                if (e.key === "ArrowUp") direction2 = "up";
                if (e.key === "ArrowDown") direction2 = "down";
            }
        });

        // document.addEventListener("keyup", (e) => {
        //     if (e.key === "ArrowUp" || e.key === "ArrowDown") direction = null;
        //     if (!aiEnabled) {
        //         if (e.key === "w" || e.key === "s") direction2 = null;
        //     }
        // });

        function resetBall() {
            ballX = window.innerWidth / 2 - ballSize / 2;
            ballY = window.innerHeight / 2 - ballSize / 2;
            ballSpeedX *= -1; // send ball in opposite direction
        }

        let direction2 = null;

        function move() {
            // Player 1 movement
             if (direction === "up") {
                if (y <= 10) {
                    direction = null;
                }
                if (direction != null) {
                    y -= speed;
                }
            }

            if (direction === "down") {
                if (y >= 420) {
                    direction = null;
                }
                if (direction != null) {
                    y += speed;
                }
            }

            box.style.top = y + "px";
            box.style.left = x + "px";

            // --- Opponent movement ---
            if (aiEnabled) {
                // AI mode
                let screenMid = window.innerWidth / 2;
                if (ballX > screenMid) {
                    let aiCenter = aiY + boxHeight / 2;
                    if (aiCenter < ballY) aiY += 3;
                    else if (aiCenter > ballY) aiY -= 3;

                    if (aiY < 10) aiY = 10;
                    if (aiY > window.innerHeight - boxHeight - 10) aiY = window.innerHeight - boxHeight - 10;
                }
            } else {
                // Player 2 mode
                if (direction2 === "up") {
                    if (aiY > 10) aiY -= speed;
                }
                if (direction2 === "down") {
                    if (aiY < window.innerHeight - boxHeight - 10) aiY += speed;
                }
            }

            ai.style.top = aiY + "px";

            // Ball movement
            ballX += ballSpeedX;
            ballY += ballSpeedY;

            if (ballY <= 0 || ballY + ballSize >= window.innerHeight) {
                ballSpeedY *= -1;
            }

            if (ballX <= 0) {
                aiScore++;
                scoreBoard.textContent = `Player: ${playerScore} | Opponent: ${aiScore}`;
                resetBall();
            }
            if (ballX + ballSize >= window.innerWidth) {
                playerScore++;
                scoreBoard.textContent = `Player: ${playerScore} | Opponent: ${aiScore}`;
                resetBall();
            }

            // Collision with player
            if (
                ballX < x + boxWidth &&
                ballX + ballSize > x &&
                ballY < y + boxHeight &&
                ballY + ballSize > y
            ) {
                ballSpeedX *= -1;
                ballX = x + boxWidth;
            }

            // Collision with AI/Player 2
            const aiX = window.innerWidth - boxWidth - 10;
            if (
                ballX < aiX + boxWidth &&
                ballX + ballSize > aiX &&
                ballY < aiY + boxHeight &&
                ballY + ballSize > aiY
            ) {
                ballSpeedX *= -1;
                ballX = aiX - ballSize;
            }

            ball.style.left = ballX + "px";
            ball.style.top = ballY + "px";

            requestAnimationFrame(move);
        }

        // Button listeners
        aiBtn.addEventListener("click", () => {
            aiEnabled = true;
            modeSelect.style.display = "none";
            ballSpeedX = 5;
            ballSpeedY = 5;
            move();
        });

        p2Btn.addEventListener("click", () => {
            aiEnabled = false;
            modeSelect.style.display = "none";
            ballSpeedX = 5;
            ballSpeedY = 5;
            move();
        });

        move();
    </script>
</body>

</html>
